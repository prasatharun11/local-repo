import java.io.File;
import java.nio.file.Paths;
import java.nio.file.Path;
import java.nio.file.InvalidPathException;

String linkidParam = request.getParameter("linkid");

try {
    int linkid = Integer.parseInt(linkidParam.trim()); // Trim to remove accidental spaces

    // Ensure linkid is within the valid range (including 10000 and 50000)
    if (linkid < 10000 || linkid > 50000) {
        throw new IllegalArgumentException("Invalid link ID: Out of range");
    }

    // Construct the file path safely
    String baseFolder = String.valueOf(ServiceFactory.getInstance().getAppGlobalFolder());
    Path folderPath = Paths.get(baseFolder, linkid + ".pdf").normalize();

    // Ensure the path is within the allowed base directory
    Path basePath = Paths.get(baseFolder).toAbsolutePath();
    if (!folderPath.toAbsolutePath().startsWith(basePath)) {
        throw new SecurityException("Potential path traversal attack detected");
    }

    File file = folderPath.toFile();
} catch (NumberFormatException e) {
    throw new IllegalArgumentException("Invalid link ID: Not a valid number", e);
} catch (InvalidPathException e) {
    throw new IllegalArgumentException("Invalid file path", e);
}